<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thông tin cá nhân - 3TD SHOP</title>
    <link rel="icon" type="image/png" href="Image_Showroom/Slogan_w_logo.png">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- FontAwesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" rel="stylesheet">
    <!-- Boxicons -->
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Rajdhani:wght@300;400;500;600;700&family=Audiowide&family=Syncopate:wght@400;700&display=swap" rel="stylesheet">

    <!-- CSS -->
    <link rel="stylesheet" href="HTML/Style/common.css">
    <link rel="stylesheet" href="HTML/Style/profile.css">

    <script>
        window.API_BASE = "https://fn-web.onrender.com";
    </script>
    <script src="Script/js_authsync.js" defer></script>
    <script src="Script/js_cartcount.js" defer></script>
    <script src="Script/js_ordercount.js" defer></script>
</head>
<body class="cyber-body">
<div id="header-container"></div>

<div class="container-fluid py-4 cyber-main">
    <div class="row g-4">
        <!-- Sidebar -->
        <div class="col-lg-3 col-md-4">
            <div class="profile-sidebar p-3 rounded-3 shadow">
                <div class="text-center mb-3 profile-avatar-wrapper">
                    <div class="avatar-shell">
                        <img id="sidebarAvatar" alt="avatar" class="rounded-circle border border-primary user-main-avatar" width="80" height="80">
                    </div>

                    <!-- HÀNG CHỈNH SỬA AVATAR (icon + chữ trên 1 hàng) -->
                    <div class="avatar-edit-row mt-2">
                        <button type="button" id="changeAvatarBtn" class="btn btn-avatar-edit">
                            <i class="fa-solid fa-camera-retro me-1"></i>
                            <span>Chỉnh sửa</span>
                        </button>
                        <!-- Input ẩn để chọn ảnh -->
                        <input type="file"
                               id="avatarFile"
                               class="d-none"
                               accept="image/*,.png,.jpg,.jpeg,.jfif,.pjpeg,.pjp,.webp,.avif,.gif,.svg,.ico,.cur,.bmp,.dib,.tif,.tiff,.heic,.heif,.jxl,.psd">
                    </div>
                    <div id="userPointsDisplay" class="mt-2 small fw-semibold text-info"></div>

                    <!-- TÊN NGƯỜI DÙNG (bên dưới hàng chỉnh sửa) -->
                    <h5 id="sidebarName" class="mt-2 user-display-name">User Name</h5>

                    <!-- Thông báo upload -->
                    <div id="avatarUploadMsg" class="small mt-1 avatar-msg"></div>
                </div>
                <ul class="list-unstyled sidebar-menu">
                    <li class="active" data-target="tab-profile"><i class="fa-solid fa-user"></i> Thông tin tài khoản</li>
                    <li data-target="tab-address"><i class="fa-solid fa-location-dot"></i> Sổ địa chỉ</li>
                    <li data-target="tab-orders"><i class="fa-solid fa-box"></i> Quản lý đơn hàng</li>
                    <li data-target="tab-viewed"><i class="fa-solid fa-eye"></i> Sản phẩm đã xem</li>
                    <li id="logoutBtn"><i class="fa-solid fa-right-from-bracket"></i> Đăng xuất</li>
                </ul>
            </div>
        </div>

        <!-- Content -->
        <div class="col-lg-9 col-md-8">
            <div class="profile-content p-4 rounded-3 shadow">

                <!-- Tab: Thông tin tài khoản -->
                <div class="tab-pane" id="tab-profile">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4 class="mb-0">
                            <i class="fa-solid fa-user-gear me-2"></i>Thông tin tài khoản
                        </h4>
                        <button id="editBtn" class="cyber-edit-btn" type="button" title="Chỉnh sửa">
                            <i class="fa-solid fa-pen-to-square"></i>
                        </button>
                    </div>

                    <form id="profileForm" class="row g-3">
                        <div class="col-md-6">
                            <label for="firstName" class="form-label">Họ</label>
                            <input type="text" id="firstName" class="form-control neon-input" readonly>
                        </div>
                        <div class="col-md-6">
                            <label for="lastName" class="form-label">Tên</label>
                            <input type="text" id="lastName" class="form-control neon-input" readonly>
                        </div>

                        <div class="col-md-6">
                            <label for="gender" class="form-label">Giới tính</label>
                            <select id="gender" class="form-select neon-input readonly-select">
                                <option value="male">Nam</option>
                                <option value="female">Nữ</option>
                                <option value="other">Khác</option>
                            </select>
                        </div>

                        <!-- Phone + OTP -->
                        <div class="col-md-6">
                            <label for="phone" class="form-label">Số điện thoại</label>
                            <div class="input-group">
                                <input type="text" id="phone" class="form-control neon-input" readonly>
                                <button type="button" class="btn d-none" id="sendOtpBtn">
                                    <i class="fa-solid fa-paper-plane"></i> OTP
                                </button>
                            </div>
                        </div>

                        <div class="col-12 otp-section d-none">
                            <label for="otpCode" class="form-label">Nhập mã OTP</label>
                            <div class="input-group">
                                <input type="text" id="otpCode" class="form-control neon-input" placeholder="Nhập OTP">
                                <button class="btn" type="button" id="verifyOtpBtn">
                                    <i class="fa-solid fa-check"></i> Xác minh
                                </button>
                            </div>
                            <small class="text-muted">Mã OTP sẽ gửi qua SMS và có hiệu lực trong 5 phút.</small>
                        </div>

                        <div class="col-md-6">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" id="email" class="form-control neon-input" readonly>
                        </div>
                        <div class="col-md-6">
                            <label for="birthday" class="form-label">Ngày sinh</label>
                            <input type="date" id="birthday" class="form-control neon-input" readonly>
                        </div>

                        <div class="col-12">
                            <button type="submit" class="btn neon-btn w-100 d-none" id="saveBtn">
                                <i class="fa-solid fa-floppy-disk me-2"></i>Lưu thay đổi
                            </button>
                        </div>
                    </form>
                    <div id="profileMessage" class="mt-3 text-center"></div>
                </div>

                <!-- Tab: Sổ địa chỉ -->
                <div class="tab-pane d-none" id="tab-address">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h4><i class="fa-solid fa-location-dot me-2"></i>Sổ địa chỉ</h4>
                        <button class="btn neon-btn" id="addAddressBtn">
                            <i class="fa-solid fa-plus"></i> Thêm địa chỉ
                        </button>
                    </div>

                    <!-- Danh sách địa chỉ -->
                    <div id="addressList" class="list-group">
                        <!-- JS sẽ đổ dữ liệu từ API /api/addresses vào đây -->
                    </div>

                    <!-- Form thêm / sửa địa chỉ -->
                    <!-- Modal Thêm / Sửa địa chỉ -->
                    <div class="modal fade" id="addressModal" tabindex="-1" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content cyber-modal">
                                <div class="modal-header border-0">
                                    <h5 class="modal-title" id="addressFormTitle">
                                        <i class="fa-solid fa-location-dot me-2"></i> Thêm địa chỉ mới
                                    </h5>
                                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                                </div>
                                <div class="modal-body">
                                    <form id="addressForm" class="row g-3">
                                        <input type="hidden" id="addressId">

                                        <div class="col-md-6">
                                            <label for="recipient_name" class="form-label">Người nhận</label>
                                            <input type="text" id="recipient_name" class="form-control neon-input" required>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="recipient_phone" class="form-label">SĐT người nhận</label>
                                            <input type="text" id="recipient_phone" class="form-control neon-input" required>
                                        </div>

                                        <div class="col-md-6">
                                            <label for="city" class="form-label">Tỉnh/Thành phố</label>
                                            <select id="city" class="form-control neon-input" required>
                                                <option value="">-- Chọn Tỉnh/Thành phố --</option>
                                            </select>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="ward" class="form-label">Phường/Xã</label>
                                            <select id="ward" class="form-control neon-input" required>
                                                <option value="">-- Chọn Xã/Phường --</option>
                                            </select>
                                        </div>

                                        <div class="col-12">
                                            <label for="street_address" class="form-label">Địa chỉ chi tiết</label>
                                            <input type="text" id="street_address" class="form-control neon-input" required>
                                        </div>

                                        <div class="col-12">
                                            <div class="form-check">
                                                <input type="checkbox" id="is_default" class="form-check-input">
                                                <label for="is_default" class="form-check-label">Đặt làm địa chỉ mặc định</label>
                                            </div>
                                        </div>
                                    </form>
                                    <div id="addressMessage" class="mt-2 text-center"></div>
                                </div>
                            <div class="modal-footer border-0">
                                <button id="cancelAddressBtn" type="button" class="btn btn-cancel" data-bs-dismiss="modal">Hủy</button>
                                <button id="saveAddressBtn" type="submit" form="addressForm" class="btn btn-save">
                                    <i class="fa-solid fa-floppy-disk me-2"></i>Lưu địa chỉ
                                </button>
                            </div>
                        </div>
                        </div>
                    </div>


                </div>

                <!-- Tab: Quản lý đơn hàng -->
                <div class="tab-pane d-none" id="tab-orders">
                    <h4><i class="fa-solid fa-box me-2"></i>Quản lý đơn hàng</h4>
                    <p>👉 Nội dung đơn hàng sẽ hiển thị ở đây.</p>
                </div>

                <!-- Tab: Sản phẩm đã xem -->
                <div class="tab-pane d-none" id="tab-viewed">
                    <h4><i class="fa-solid fa-eye me-2"></i>Sản phẩm đã xem</h4>
                    <p>👉 Nội dung sản phẩm đã xem sẽ hiển thị ở đây.</p>
                </div>

            </div>
        </div>
    </div>
</div>

<div id="footer-container"></div>

<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.12.2/lottie.min.js"></script>
<script src="Script/js_header.js" defer></script>
<script src="Script/js_resethandler.js" defer></script>
<script src="Script/js_profile.js" defer></script>
</body>
</html>
